(()=>{"use strict";var e=function(){function e(){var e=this;this._state="running",this._promise=new Promise((function(t,i){e._resolve=t,e._reject=i}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e),this._state="resolved"},e.prototype.reject=function(e){this._reject(e),this._state="rejected"},e}();!function(){function t(e){void 0===e&&(e=0),this.operations=new Map,this.operationId=e}t.prototype.add=function(){var t=this.operationId++,i=new e;return this.operations.set(t,i),[t,i.promise]},t.prototype.getResolver=function(e){if(!this.operations.has(e))return null;var t=this.operations.get(e);return this.operations.delete(e),t},t.prototype.resolve=function(e,t){var i=this.getResolver(e);return null!==i&&(i.resolve(t),!0)},t.prototype.reject=function(e,t){var i=this.getResolver(e);return null!==i&&(i.reject(t),!0)}}();const t={},i=[];function n(e,n){const r=e.charCodeAt(0),a=n.charCodeAt(0);for(let e=r;e<=a;e+=1)t[String.fromCharCode(e)]=i.length,i.push(e)}"=".charCodeAt(0),n("A","Z"),n("a","z"),n("0","9"),n("+","+"),n("/","/"),BigInt(0),BigInt(1);BigInt(2);BigInt(64);const r=Symbol("BackingField");function a(e,t){return e[r][t]}function s(e,t,i){e[r][t]=i}var o;!function(e){let t;!function(e){e[e.ArrayBuffer=0]="ArrayBuffer",e[e.String=1]="String"}(t=e.SubType||(e.SubType={})),e.initialize=function(e,i,n){switch(i.subType){case t.ArrayBuffer:Object.defineProperty(e,i.name,{configurable:!0,enumerable:!0,get:()=>a(e,i.name).buffer,set(t){s(e,i.name,{buffer:t})}});break;case t.String:Object.defineProperty(e,i.name,{configurable:!0,enumerable:!0,get:()=>a(e,i.name).string,set(t){s(e,i.name,{string:t})}});break;default:throw new Error("Unknown type")}s(e,i.name,n)}}(o||(o={}));const l={};function u(e){return l[e]}function d(e,t,i){l[i.type]=i}var c,f,h;!function(e){e[e.Number=0]="Number",e[e.FixedLengthArray=1]="FixedLengthArray",e[e.VariableLengthArray=2]="VariableLengthArray"}(c||(c={})),d(0,0,{type:c.FixedLengthArray,async deserialize({context:e,field:t}){const i=await e.read(t.options.length);switch(t.subType){case o.SubType.ArrayBuffer:return{value:i};case o.SubType.String:return{value:e.decodeUtf8(i),extra:i};default:throw new Error("Unknown type")}},getSize:({field:e})=>e.options.length,initialize({extra:e,field:t,object:i,value:n}){const r={};"string"==typeof n?(r.string=n,e&&(r.buffer=e)):r.buffer=n,o.initialize(i,t,r)},serialize({context:e,dataView:t,field:i,object:n,offset:r}){var s;const o=a(n,i.name);null!==(s=o.buffer)&&void 0!==s||(o.buffer=e.encodeUtf8(o.string)),new Uint8Array(t.buffer).set(new Uint8Array(o.buffer),r)}}),function(e){let t;!function(e){e[e.Uint8=0]="Uint8",e[e.Uint16=1]="Uint16",e[e.Int32=2]="Int32",e[e.Uint32=3]="Uint32",e[e.Uint64=4]="Uint64",e[e.Int64=5]="Int64"}(t=e.SubType||(e.SubType={})),e.SizeMap={[t.Uint8]:1,[t.Uint16]:2,[t.Int32]:4,[t.Uint32]:4,[t.Uint64]:8,[t.Int64]:8},e.DataViewGetterMap={[t.Uint8]:"getUint8",[t.Uint16]:"getUint16",[t.Int32]:"getInt32",[t.Uint32]:"getUint32",[t.Uint64]:"getBigUint64",[t.Int64]:"getBigInt64"},e.DataViewSetterMap={[t.Uint8]:"setUint8",[t.Uint16]:"setUint16",[t.Int32]:"setInt32",[t.Uint32]:"setUint32",[t.Uint64]:"setBigUint64",[t.Int64]:"setBigInt64"}}(f||(f={})),d(0,0,{type:c.Number,getSize:({field:e})=>f.SizeMap[e.subType],async deserialize({context:e,field:t,options:i}){const n=await e.read(f.SizeMap[t.subType]);return{value:new DataView(n)[f.DataViewGetterMap[t.subType]](0,i.littleEndian)}},serialize({dataView:e,field:t,object:i,offset:n,options:r}){e[f.DataViewSetterMap[t.subType]](n,i[t.name],r.littleEndian)}}),function(e){let t;function i(e,t){return a(e,t.options.lengthField)}function n(e,t,i){s(e,t.options.lengthField,i)}!function(e){e[e.Undefined=0]="Undefined",e[e.Empty=1]="Empty"}(t=e.EmptyBehavior||(e.EmptyBehavior={})),e.getLengthBackingField=i,e.setLengthBackingField=n,e.initialize=function(e,t,r,l){o.initialize(e,t,r);const u=Object.getOwnPropertyDescriptor(e,t.name);switch(delete e[t.name],t.subType){case o.SubType.ArrayBuffer:Object.defineProperty(e,t.name,{...u,set(i){var r;u.set.call(e,i),n(e,t,null!==(r=null==i?void 0:i.byteLength)&&void 0!==r?r:0)}}),delete e[t.options.lengthField],Object.defineProperty(e,t.options.lengthField,{configurable:!0,enumerable:!0,get:()=>i(e,t)});break;case o.SubType.String:Object.defineProperty(e,t.name,{...u,set(i){u.set.call(e,i),n(e,t,i?void 0:0)}}),delete e[t.options.lengthField],Object.defineProperty(e,t.options.lengthField,{configurable:!0,enumerable:!0,get(){let r=i(e,t);if(void 0===r){const i=a(e,t.name),s=l.encodeUtf8(i.string);i.buffer=s,r=s.byteLength,n(e,t,r)}return r}});break;default:throw new Error("Unknown type")}s(e,t.name,r),r.buffer&&n(e,t,r.buffer.byteLength)}}(h||(h={})),d(0,0,{type:c.VariableLengthArray,async deserialize({context:e,field:t,object:i}){let n=i[t.options.lengthField];if("string"==typeof n&&(n=Number.parseInt(n,10)),0===n){if(t.options.emptyBehavior!==h.EmptyBehavior.Empty)return{value:void 0};switch(t.subType){case o.SubType.ArrayBuffer:return{value:new ArrayBuffer(0)};case o.SubType.String:return{value:"",extra:new ArrayBuffer(0)};default:throw new Error("Unknown type")}}const r=await e.read(n);switch(t.subType){case o.SubType.ArrayBuffer:return{value:r};case o.SubType.String:return{value:e.decodeUtf8(r),extra:r};default:throw new Error("Unknown type")}},getSize:()=>0,getDynamicSize:({field:e,object:t})=>t[e.options.lengthField],initialize({context:e,extra:t,field:i,object:n,value:r}){const a={};"string"==typeof r?(a.string=r,t&&(a.buffer=t)):a.buffer=r,o.initialize(n,i,a),h.initialize(n,i,a,e)},serialize({dataView:e,field:t,object:i,offset:n}){const r=a(i,t.name);new Uint8Array(e.buffer).set(new Uint8Array(r.buffer),n)}});const y={littleEndian:!1};class g{constructor(e=y){this._size=0,this.fields=[],this._extra={},this.array=(e,t,i)=>"length"in i?this.field({type:c.FixedLengthArray,name:e,subType:t,options:i}):this.field({type:c.VariableLengthArray,name:e,subType:t,options:i}),this.arrayBuffer=(e,t)=>this.array(e,o.SubType.ArrayBuffer,t),this.string=(e,t)=>this.array(e,o.SubType.String,t),this.options={...y,...e}}get size(){return this._size}clone(){const e=new g(this.options);return e.fields=this.fields.slice(),e._size=this._size,e._extra=this._extra,e._afterParsed=this._afterParsed,e}field(e){const t=this.clone();t.fields.push(e);const i=u(e.type).getSize({field:e,options:this.options});return t._size+=i,t}number(e,t,i={},n){return this.field({type:c.Number,name:e,subType:t,options:i})}uint8(e,t={},i){return this.number(e,f.SubType.Uint8,t,i)}uint16(e,t={},i){return this.number(e,f.SubType.Uint16,t,i)}int32(e,t={},i){return this.number(e,f.SubType.Int32,t,i)}uint32(e,t={},i){return this.number(e,f.SubType.Uint32,t,i)}uint64(e,t={},i){return this.number(e,f.SubType.Uint64,t,i)}int64(e,t={},i){return this.number(e,f.SubType.Int64,t,i)}extra(e){const t=this.clone();return t._extra={...t._extra,...Object.getOwnPropertyDescriptors(e)},t}afterParsed(e){const t=this.clone();return t._afterParsed=e,t}initializeField(e,t,i,n,r,o){i.initialize?i.initialize({context:e,extra:o,field:t,object:n,options:this.options,value:r}):(s(n,t.name,r),function(e,t){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:()=>a(e,t),set(i){s(e,t,i)}})}(n,t.name))}create(e,t){const i={[r]:{}};Object.defineProperties(i,this._extra);for(const n of this.fields){const r=u(n.type);this.initializeField(t,n,r,i,e[n.name])}return i}async deserialize(e){const t={[r]:{}};Object.defineProperties(t,this._extra);for(const i of this.fields){const n=u(i.type),{value:r,extra:a}=await n.deserialize({context:e,field:i,object:t,options:this.options});this.initializeField(e,i,n,t,r,a)}if(this._afterParsed){const e=this._afterParsed.call(t,t);if(e)return e}return t}serialize(e,t){const i=this.create(e,t);let n=this._size,r=[];for(let e=0;e<this.fields.length;e+=1){const a=this.fields[e],s=u(a.type);s.getDynamicSize?(r[e]=s.getDynamicSize({context:t,field:a,object:i,options:this.options}),n+=r[e]):r[e]=s.getSize({field:a,options:this.options})}const a=new ArrayBuffer(n),s=new DataView(a);let o=0;for(let e=0;e<this.fields.length;e+=1){const n=this.fields[e];u(n.type).serialize({context:t,dataView:s,field:n,object:i,offset:o,options:this.options}),o+=r[e]}return a}}class b{constructor(e){this.stream=e}async read(e){let t,i;if(this.buffer){const n=this.buffer;if(n.byteLength>e)return this.buffer=n.subarray(e),n.slice(0,e).buffer;t=new Uint8Array(e),t.set(n),i=n.byteLength,this.buffer=void 0}else{const n=await this.stream.read(e);if(n.byteLength===e)return n;if(n.byteLength>e)return this.buffer=new Uint8Array(n,e),n.slice(0,e);t=new Uint8Array(e),t.set(new Uint8Array(n),0),i=n.byteLength}for(;i<e;){const n=e-i,r=await this.stream.read(n);if(r.byteLength>n)return t.set(new Uint8Array(r,0,n),i),this.buffer=new Uint8Array(r,n),t.buffer;t.set(new Uint8Array(r),i),i+=r.byteLength}return t.buffer}close(){var e,t;null===(t=(e=this.stream).close)||void 0===t||t.call(e)}}var p,w;(w=p||(p={}))[w.Auth=1213486401]="Auth",w[w.Close=1163086915]="Close",w[w.Connect=1314410051]="Connect",w[w.OK=1497451343]="OK",w[w.Open=1313165391]="Open",w[w.Write=1163154007]="Write";const m=new g({littleEndian:!0}).uint32("command",void 0).uint32("arg0").uint32("arg1").uint32("payloadLength").uint32("checksum").int32("magic"),E=m.arrayBuffer("payload",{lengthField:"payloadLength"}).afterParsed((e=>{if(e[r].magic!==e.magic)throw new Error("Invalid command")}));var S,v,T,L;(T=S||(S={})).create=function(e,t,i){let n;return n=t&&e.payload?new Uint8Array(e.payload).reduce(((e,t)=>e+t),0):0,E.create({...e,checksum:n,magic:4294967295^e.command},i)},T.read=async function(e){let t=await e.read(24);24!==t.byteLength&&(t=await e.read(24));let i=!1;const n=new b({read:n=>i?e.read(n):(i=!0,t)});return E.deserialize({read:n.read.bind(n),decodeUtf8:e.decodeUtf8.bind(e),encodeUtf8:e.encodeUtf8.bind(e)})},T.write=async function(e,t){await t.write(m.serialize(e,t)),e.payload&&await t.write(e.payload)},function(e){e[e.Token=1]="Token",e[e.Signature=2]="Signature",e[e.PublicKey=3]="PublicKey"}(v||(v={}));!function(e){e.Hidden="null",e.Level0="0",e.Level1="1",e.Level2="2",e.Level3="3",e.Level4="4"}(L||(L={}));class A extends class extends class{constructor(){this.disposables=[],this.dispose=this.dispose.bind(this)}addDisposable(e){return this.disposables.push(e),e}dispose(){for(const e of this.disposables)e.dispose();this.disposables=[]}}{constructor(e){super(),this.adb=e}}{async getAllowed(){return"1"===(await this.adb.exec("settings","get","global",A.AllowedSettingKey)).trim()}async setAllowed(e){e?await this.adb.exec("settings","put","global",A.AllowedSettingKey,"1"):(await this.setEnabled(!1),await this.adb.exec("settings","delete","global",A.AllowedSettingKey))}async getEnabled(){return"1"===(await this.adb.exec("settings","get","global",A.EnabledSettingKey)).trim()}async setEnabled(e){e?await this.adb.exec("settings","put","global",A.EnabledSettingKey,"1"):(await this.adb.exec("settings","delete","global",A.EnabledSettingKey),await this.broadcast("exit"))}async broadcast(e,t){await this.adb.exec("am","broadcast","-a","com.android.systemui.demo","-e","command",e,...t?Object.entries(t).flatMap((([e,t])=>["-e",e,t])):[])}async setBatteryLevel(e){await this.broadcast("battery",{level:e.toString()})}async setBatteryCharging(e){await this.broadcast("battery",{plugged:e.toString()})}async setPowerSaveMode(e){await this.broadcast("battery",{powersave:e.toString()})}async setAirplaneMode(e){await this.broadcast("network",{airplane:e?"show":"hide"})}async setWifiSignalStrength(e){await this.broadcast("network",{wifi:"show",level:e})}async setMobileDataType(e){for(let t=0;t<2;t+=1)await this.broadcast("network",{mobile:"show",sims:"1",nosim:"hide",slot:"0",datatype:e,fully:"true",roam:"false",level:"4",inflate:"false",activity:"in",carriernetworkchange:"hide"})}async setMobileSignalStrength(e){await this.broadcast("network",{mobile:"show",level:e})}async setNoSimCardIcon(e){await this.broadcast("network",{nosim:e?"show":"hide"})}async setStatusBarMode(e){await this.broadcast("bars",{mode:e})}async setVibrateModeEnabled(e){await this.broadcast("status",{volume:e?"vibrate":"hide"})}async setBluetoothConnected(e){await this.broadcast("status",{bluetooth:e?"connected":"hide"})}async setLocatingIcon(e){await this.broadcast("status",{location:e?"show":"hide"})}async setAlarmIcon(e){await this.broadcast("status",{alarm:e?"show":"hide"})}async setSyncingIcon(e){await this.broadcast("status",{sync:e?"show":"hide"})}async setMuteIcon(e){await this.broadcast("status",{mute:e?"show":"hide"})}async setSpeakerPhoneIcon(e){await this.broadcast("status",{speakerphone:e?"show":"hide"})}async setNotificationsVisibility(e){await this.broadcast("notifications",{visible:e.toString()})}async setTime(e,t){await this.broadcast("clock",{hhmm:`${e.toString().padStart(2,"0")}${t.toString().padStart(2,"0")}`})}}A.AllowedSettingKey="sysui_demo_allowed",A.EnabledSettingKey="sysui_tuner_demo_on",new g({littleEndian:!0}).uint32("version"),new g({littleEndian:!0}).uint32("bpp").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").arrayBuffer("data",{lengthField:"size"}),new g({littleEndian:!0}).uint32("bpp").uint32("colorSpace").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").arrayBuffer("data",{lengthField:"size"});var U,z;new g({littleEndian:!0}).string("length",{length:4}).string("content",{lengthField:"length"}).afterParsed((e=>{throw new Error(e.content)})),(z=U||(U={})).List="LIST",z.Send="SEND",z.Lstat="STAT",z.Stat="STA2",z.Lstat2="LST2",z.Data="DATA",z.Done="DONE",z.Receive="RECV";var I,O,_,x;new g({littleEndian:!0}).string("id",{length:4}).uint32("arg").arrayBuffer("data",{lengthField:"arg"}),(O=I||(I={})).Entry="DENT",O.Lstat="STAT",O.Stat="STA2",O.Lstat2="LST2",O.Done="DONE",O.Data="DATA",O.Ok="OKAY",O.Fail="FAIL";class F{constructor(e){this.id=I.Done,this.length=e}async deserialize(e){return await e.read(this.length),this}}new g({littleEndian:!0}).uint32("messageLength").string("message",{lengthField:"messageLength"}).afterParsed((e=>{throw new Error(e.message)})),(x=_||(_={}))[x.Directory=4]="Directory",x[x.File=8]="File",x[x.Link=10]="Link";const B=new g({littleEndian:!0}).int32("mode").int32("size").int32("mtime").extra({id:I.Lstat,get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).afterParsed((e=>{if(0===e.mode&&0===e.size&&0===e.mtime)throw new Error("lstat failed")}));var P;!function(e){e[e.EACCES=13]="EACCES",e[e.EEXIST=17]="EEXIST",e[e.EFAULT=14]="EFAULT",e[e.EFBIG=27]="EFBIG",e[e.EINTR=4]="EINTR",e[e.EINVAL=22]="EINVAL",e[e.EIO=5]="EIO",e[e.EISDIR=21]="EISDIR",e[e.ELOOP=40]="ELOOP",e[e.EMFILE=24]="EMFILE",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENFILE=23]="ENFILE",e[e.ENOENT=2]="ENOENT",e[e.ENOMEM=12]="ENOMEM",e[e.ENOSPC=28]="ENOSPC",e[e.ENOTDIR=20]="ENOTDIR",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EPERM=1]="EPERM",e[e.EROFS=30]="EROFS",e[e.ETXTBSY=26]="ETXTBSY"}(P||(P={}));new g({littleEndian:!0}).uint32("error",void 0,void 0).uint64("dev").uint64("ino").uint32("mode").uint32("nlink").uint32("uid").uint32("gid").uint64("size").uint64("atime").uint64("mtime").uint64("ctime").extra({id:I.Stat,get type(){return this.mode>>12},get permission(){return 4095&this.mode}}).afterParsed((e=>{if(e.error)throw new Error(P[e.error])}));I.Stat,I.Lstat,I.Lstat2;const D=B.afterParsed().uint32("nameLength").string("name",{lengthField:"nameLength"}).extra({id:I.Entry});I.Entry,I.Done,new F(D.size);const j=new g({littleEndian:!0}).uint32("dataLength").arrayBuffer("data",{lengthField:"dataLength"}).extra({id:I.Data});I.Data,I.Done,new F(j.size);new g({littleEndian:!0}).uint32("unused");var N,k,M;I.Ok,(M=N||(N={})).StatV2="stat_v2",M.Cmd="cmd",function(e){e.Product="ro.product.name",e.Model="ro.product.model",e.Device="ro.product.device",e.Features="features"}(k||(k={})),new TextEncoder,new TextDecoder})();